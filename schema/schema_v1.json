{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "AutomatedSQLi Log Schema v1",
  "description": "Schema for unified logging across components (requests, responses, DB events).",
  "type": "object",
  "properties": {
    "timestamp": { "type": "string", "format": "date-time" },
    "trace_id": { "type": "string", "pattern": "^[a-f0-9\\-]{36}$" },
    "round": { "type": "integer", "minimum": 1 },
    "tool": { "type": "string", "enum": ["scanner", "proxy", "db_logger", "analyzer"] },
    "payload_id": { "type": "string" },

    "src_ip": { "type": "string", "format": "ipv4" },
    "method": { "type": "string", "enum": ["GET", "POST", "PUT", "DELETE"] },
    "url": { "type": "string" },
    "headers": { "type": "object" },
    "params": { "type": "object" },
    "body_snippet": { "type": "string", "maxLength": 256 },

    "response_code": { "type": "integer" },
    "response_time_ms": { "type": "integer" },

    "db_query": { "type": ["string", "null"] },
    "db_status": { "type": ["string", "null"], "enum": ["ok", "error", "warning", null] },

    "label": { "type": "string", "enum": ["benign", "suspicious", "exploit"] },
    "confidence": { "type": "number", "minimum": 0, "maximum": 1 },

    "meta": {
      "type": "object",
      "properties": {
        "hash_salt": { "type": "string" },
        "version": { "type": "string" },
        "notes": { "type": "string" }
      },
      "required": ["version"]
    }
  },
  "required": ["timestamp", "trace_id", "round", "tool", "src_ip", "method", "url", "label"],
  "additionalProperties": false
}
